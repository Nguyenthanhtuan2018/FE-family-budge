<template><div class='card'><h2>Transactions</h2><div class='row'><select v-model='form.type'><option value='expense'>Expense</option><option value='income'>Income</option><option value='transfer'>Transfer</option></select><input v-model.number='form.amount' type='number' placeholder='Amount'/><select v-model='form.currency'><option value='VND'>VND</option><option value='USD'>USD</option></select><input v-model='form.occurred_at' type='datetime-local'/><input v-model='form.note' type='text' placeholder='Note' style='min-width:200px'/><button :disabled='saving' @click='add'>Add</button></div><table style='margin-top:12px;'><thead><tr><th style='width:120px;'>Type</th><th class='amount' style='width:120px;'>Amount</th><th style='width:80px;'>Cur</th><th style='width:200px;'>Time</th><th>Note</th></tr></thead><tbody><tr v-for='it in tx.items' :key='it.id'><td>{{ it.type }}</td><td class='amount'>{{ it.amount }}</td><td>{{ it.currency }}</td><td>{{ it.occurred_at }}</td><td>{{ it.note }}</td></tr></tbody></table></div></template><script setup>import { reactive, onMounted, ref } from 'vue'; import { useTransactions } from '../stores/transactions.js'; const tx=useTransactions(); const saving=ref(false); const now=new Date(); const localISO=new Date(now.getTime()-now.getTimezoneOffset()*60000).toISOString().slice(0,16); const form=reactive({ type:'expense', amount:0, currency:'VND', occurred_at:localISO, note:'' }); onMounted(()=>tx.fetch()); async function add(){ saving.value=true; try{ const payload={...form}; if(!payload.amount||payload.amount<=0) throw new Error('Amount must be > 0'); await tx.create(payload); form.amount=0; form.note=''; }catch(e){ alert(e.message||'Failed'); }finally{ saving.value=false; } }</script>